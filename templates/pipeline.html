<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Audio Pipeline - {{ pipeline_name }}</title>
        <script type="importmap">
            {
                "imports": {
                    "d3": "https://cdn.jsdelivr.net/npm/d3@7/+esm"
                }
            }
        </script>
        <script
            defer
            src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
        ></script>
        <script src="https://cdn.tailwindcss.com"></script>
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
            rel="stylesheet"
        />
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        fontFamily: {
                            sans: ["Inter", "system-ui", "sans-serif"],
                        },
                    },
                },
            };
        </script>
    </head>
    <body
        class="bg-gradient-to-br from-dark-50 via-primary-50 to-dark-100 min-h-screen"
    >
        <!-- Main Container -->
        <div class="min-h-screen py-8 px-4 sm:px-6 lg:px-8">
            <div class="max-w-7xl mx-auto">
                <!-- Header Card -->
                <div
                    class="bg-white rounded-2xl shadow-large overflow-hidden mb-8"
                >
                    <div
                        class="relative bg-gradient-to-r from-primary-600 via-primary-500 to-accent px-8 py-12"
                    >
                        <div class="absolute inset-0 bg-black/5"></div>
                        <div class="relative">
                            <div class="flex items-center justify-center mb-4">
                                <div
                                    class="w-16 h-16 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center text-4xl"
                                >
                                    ðŸŽµ
                                </div>
                            </div>
                            <h1
                                class="text-4xl lg:text-5xl font-bold text-white text-center mb-2 tracking-tight"
                            >
                                Audio Pipeline
                            </h1>
                            <p
                                class="text-primary-100 text-center text-lg font-medium"
                            >
                                {{ pipeline_name }}
                            </p>

                            <!-- Metadata Pills -->
                            <div
                                class="flex flex-wrap justify-center gap-3 mt-8"
                            >
                                <div
                                    class="bg-white/10 backdrop-blur-md border border-white/20 px-4 py-2.5 rounded-xl"
                                >
                                    <div class="flex items-center gap-2">
                                        <span
                                            class="text-white/70 text-xs font-medium uppercase tracking-wider"
                                            >Duration</span
                                        >
                                        <span class="text-white font-semibold"
                                            >{{ duration }}s</span
                                        >
                                    </div>
                                </div>
                                <div
                                    class="bg-white/10 backdrop-blur-md border border-white/20 px-4 py-2.5 rounded-xl"
                                >
                                    <div class="flex items-center gap-2">
                                        <span
                                            class="text-white/70 text-xs font-medium uppercase tracking-wider"
                                            >Sample Rate</span
                                        >
                                        <span class="text-white font-semibold"
                                            >{{ sample_rate }} Hz</span
                                        >
                                    </div>
                                </div>
                                <div
                                    class="bg-white/10 backdrop-blur-md border border-white/20 px-4 py-2.5 rounded-xl"
                                >
                                    <div class="flex items-center gap-2">
                                        <span
                                            class="text-white/70 text-xs font-medium uppercase tracking-wider"
                                            >Samples</span
                                        >
                                        <span class="text-white font-semibold"
                                            >{{ total_samples }}</span
                                        >
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Audio Player Card -->
                <div
                    class="bg-white rounded-2xl shadow-soft overflow-hidden mb-8 border border-dark-100"
                >
                    <div class="px-8 py-6 border-b border-dark-100">
                        <div class="flex items-center gap-3">
                            <div
                                class="w-10 h-10 bg-primary-100 rounded-xl flex items-center justify-center text-xl"
                            >
                                ðŸ”Š
                            </div>
                            <div>
                                <h2 class="text-xl font-bold text-dark-900">
                                    Audio Output
                                </h2>
                                <p class="text-sm text-dark-500">
                                    Generated waveform audio
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="px-8 py-8 bg-dark-50">
                        <div class="max-w-3xl mx-auto">
                            <audio
                                controls
                                class="w-full"
                                style="filter: hue-rotate(220deg) saturate(1.2)"
                            >
                                <source
                                    src="data:audio/wav;base64,{{ audio_base64 }}"
                                    type="audio/wav"
                                />
                                Your browser does not support the audio element.
                            </audio>
                        </div>
                    </div>
                </div>

                <!-- Statistics Grid -->
                <div class="grid grid-cols-1 gap-6 mb-8">
                    <div
                        class="group bg-white rounded-2xl shadow-soft hover:shadow-medium transition-all duration-300 overflow-hidden border border-dark-100"
                    >
                        <div class="p-6">
                            <div class="flex items-center justify-between mb-4">
                                <div
                                    class="w-12 h-12 bg-gradient-to-br from-primary-500 to-primary-600 rounded-xl flex items-center justify-center text-white font-bold text-lg shadow-lg"
                                >
                                    {{ component_htmls.len() }}
                                </div>
                                <div
                                    class="w-10 h-10 bg-primary-50 rounded-lg flex items-center justify-center text-xl opacity-70 group-hover:opacity-100 transition-opacity"
                                >
                                    ðŸ“¦
                                </div>
                            </div>
                            <h3
                                class="text-sm font-semibold text-dark-500 uppercase tracking-wide"
                            >
                                Total Components
                            </h3>
                        </div>
                    </div>
                </div>

                <!-- Component Flow Section -->
                <div
                    class="bg-white rounded-2xl shadow-soft overflow-hidden border border-dark-100 mb-8"
                >
                    <div class="px-8 py-6 border-b border-dark-100 bg-dark-50">
                        <div class="flex items-center gap-3">
                            <div
                                class="w-10 h-10 bg-primary-100 rounded-xl flex items-center justify-center text-xl"
                            >
                                ðŸ”€
                            </div>
                            <div>
                                <h2 class="text-xl font-bold text-dark-900">
                                    Pipeline Flow
                                </h2>
                                <p class="text-sm text-dark-500">
                                    Component-by-component breakdown
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="p-8 space-y-6">
                        {% for html in component_htmls %} {{ html|safe }} {%
                        endfor %}
                    </div>
                </div>

                <!-- Footer -->
                <div class="text-center py-8">
                    <p class="text-dark-500 text-sm font-medium">
                        Generated with Audio Pipeline Visualizer
                    </p>
                </div>
            </div>
        </div>
    </body>
</html>
